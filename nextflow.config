
profiles {

    travis {
        docker {
            quest = false
            enabled = true
            temp = 'auto'
            runOptions = '-u `id -u $USER`'
        }
        cores = 2
        echo = true
    }

    local {
        params {
            quest = false
            debug = true
            reference = "WS245/WS245.fa.gz"
        }

        docker {
            enabled = true
        }

        process {
            container = "andersenlab/nil-ril-nf"
        }
    }

    quest_debug {

        params {
            quest = true
            genome = "WS245"
            debug = true
            tmpdir = "/projects/b1042/AndersenLab/tmp"
            reference = "/projects/b1059/data/genomes/c_elegans/${genome}/${genome}.fa.gz"
        }

        process {
            container = 'docker://andersenlab/nil-ril-nf'
            executor = 'slurm'
            queue = 'genomicsguestA'
            clusterOptions = '-A b1042 -t 48:00:00 -e errlog.txt'
        }

        singularity {

            enabled = true
            autoMounts = true

            cacheDir = "/projects/b1059/workflows/nil-ril-nf/singularity_cache"
            pullTimeout = '20 min'
        }

    }

    quest {

        params {
            quest = true
            genome = "WS245"
            tmpdir = "/projects/b1042/AndersenLab/tmp"
        }

        process {
            container = 'docker://andersenlab/nil-ril-nf'
            executor = 'slurm'
            queue = 'genomicsguestA'
            clusterOptions = '-A b1042 -t 48:00:00 -e errlog.txt'
            maxRetries=3
        }

        singularity {

            enabled = true
            autoMounts = true

            cacheDir = "/projects/b1059/workflows/nil-ril-nf/singularity_cache"
            pullTimeout = '20 min'
        }
    }

}

import java.time.*
Date now = new Date()
day = now.format("yyyMMdd")
timestamp = now.format("yyyyMMdd-HH-mm-ss")
params.A = 'N2'
params.B = 'CB4856'
params.out = "NIL-${params.A}-${params.B}-${day}"

report {
    enabled = true
    file = "${params.out}/${timestamp}_report.html"

}

timeline {
    enabled = true
    file = "${params.out}/${timestamp}_timeline.html"
}
